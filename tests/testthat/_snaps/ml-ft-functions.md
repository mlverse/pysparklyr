# Binarizer works

    Code
      class(ft_binarizer(sc, "a", "b"))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_binarizer(ml_pipeline(sc), "a", "b"))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

# Bucket Random Projection LSH works

    Code
      class(ft_bucketed_random_projection_lsh(sc, "a", "b"))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_bucketed_random_projection_lsh(ml_pipeline(sc), "a", "b"))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

# Bucketizer works

    Code
      class(ft_bucketizer(sc, "a", "b", c(1, 2, 3)))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_bucketizer(ml_pipeline(sc), "a", "b", c(1, 2, 3)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

# Count vectorizer works

    Code
      class(ft_count_vectorizer(sc, "a", "b"))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_count_vectorizer(ml_pipeline(sc), "a", "b"))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x)
    Output
      [[1]]
      SparseVector(13, {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0, 4: 1.0, 5: 1.0, 6: 1.0, 7: 1.0, 8: 1.0, 9: 1.0, 10: 1.0, 11: 1.0, 12: 1.0})
      

# DCT works

    Code
      class(ft_dct(sc, "a", "b"))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_dct(ml_pipeline(sc), "a", "b"))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x)
    Output
      [[1]]
      DenseVector([0.4063, -0.151, 0.0764, 0.2688, -0.0889, 0.0285, 0.0943, -0.2138, 0.0875, -0.0171, -0.1472, 0.0205, 0.0818, -0.0261, 0.0428, 0.0366, 0.1673, -0.0501, 0.135, -0.0842, 0.154, -0.0775, -0.038, -0.0099, -0.0187, -0.0396, -0.042, -0.0864, 0.0686, -0.0516, -0.1092, -0.0096, 0.0318, -0.174, -0.0046, -0.1236, 0.0189, -0.1394, 0.0274, -0.1352, 0.1185, -0.0216, -0.0613, 0.0733, 0.0515, -0.0491, -0.0455, -0.0439, -0.0119, -0.1716, -0.0824, -0.1275, -0.0297, -0.14, 0.0185, -0.1034, 0.1653, 0.0012, 0.0521, 0.0717, 0.2326, -0.0553, 0.0061, 0.2039, -0.1578, 0.0063, 0.0767, -0.2898, 0.2057, -0.0703, -0.1755, 0.1938, 0.0889, -0.1371, 0.2876, -0.0553, 0.1855, 0.0577, -0.0004, 0.1359, 0.0171, 0.0512, -0.0068, 0.0075, 0.1605, -0.0936, 0.0503, 0.0777, 0.0459, -0.0407, 0.0599, -0.0691, 0.1176, -0.1557, 0.0189, -0.0168, -0.0014, -0.0062, -0.0301, 0.0786, 0.0667, 0.0272, 0.0083, 0.0579, 0.1126, -0.1821, 0.0293, -0.0584, -0.1259, -0.1536, -0.0515, -0.2385, 0.0567, -0.135, -0.1258, 0.1173, 0.0279, -0.0625, 0.0695, 0.1148, -0.0515, -0.0089, 0.0186, -0.1476, 0.0411, -0.1806, -0.1031, -0.0828, 0.018, -0.1864, -0.0136, 0.0765, -0.0221, -0.046, 0.116, 0.0049, 0.0131, 0.0954, -0.1181, 0.1167, 0.0636, -0.1526, 0.1678, -0.0566, 0.1273, -0.0285, -0.0008, 0.1694, -0.0213, -0.0687, 0.1613, -0.1157, 0.0565, 0.0486, -0.1784, 0.2375, -0.009, -0.0522, 0.2332, 0.0304, 0.1674, 0.0564, 0.0977, 0.1068, 0.076, -0.1017, 0.0483, -0.0252, -0.1109, -0.0559, -0.071, -0.0435, 0.0281, -0.0206, -0.0695, 0.2644, -0.0136, -0.0752, 0.3036, -0.1102, 0.0257, 0.0551, -0.1461, -0.0489, 0.0379, -0.2767, -0.0666, 0.0796, -0.228, -0.0526, 0.0475, -0.0532, -0.063, 0.0546, -0.0955, 0.0087, 0.0494, -0.2002, 0.0495, -0.0047, -0.0693, -0.0875, 0.0574, -0.0121, -0.0532, 0.0241, -0.0795, 0.0794, -0.0923, -0.1064, 0.0246, -0.0676, -0.1015, 0.0272, -0.1138, 0.0975, 0.1055, -0.1856, 0.3421, 0.0471, -0.03, 0.2678, -0.0711, 0.1219, 0.0505, -0.1432, 0.0472, 0.0187, -0.1774, 0.0559, -0.0655, 0.0755, 0.0632, -0.0462, 0.2412, 0.0968, 0.0718, 0.1123, 0.141, 0.0509, 0.006, 0.0818, -0.131, 0.1227, -0.0634, -0.1613, 0.1114, 0.0558, -0.2131, 0.1684, 0.0237, -0.0905, 0.1543, -0.1017, 0.0044, 0.0899, -0.0887, -0.0741, 0.0519, 0.0532, -0.1867, 0.1054, -0.0093, -0.0287, -0.0269, -0.0115, -0.1026, 0.0297, -0.1462, -0.1685, 0.0176, -0.1394, -0.1349, -0.0409, -0.0325, 0.0131, -0.0224, 0.0208, 0.0657, 0.1409, -0.1617, 0.1702, -0.0653, -0.0647, -0.0033, -0.1974, -0.0502, 0.0064, -0.2542, 0.0088, 0.053, -0.0779, 0.0825, 0.0326, 0.1172, 0.1542, -0.0808, 0.2543, -0.0792, 0.1257, 0.0068, -0.1113, 0.1189, 0.0291, -0.1846, 0.146, 0.0463, -0.051, 0.0953, 0.0432, 0.0454, 0.0974, -0.0006, 0.0381, 0.0326, 0.1694, -0.1942, 0.1882, 0.0656, -0.0029, 0.0615, 0.085, 0.0532, 0.0674, -0.0346, 0.0351, -0.0157, -0.0334, -0.0855, -0.114, 0.0148, -0.0264, -0.2345, 0.2021, -0.0881, 0.0564, 0.0372, 0.064, 0.0484, 0.0925, -0.0987, 0.0125, 0.0043, -0.1559, -0.1289, -0.0944, -0.1383, -0.0656, -0.2086, 0.0101, -0.0188, -0.0195, -0.0824, 0.1764, -0.0884, 0.1097, -0.0624, 0.0043, 0.0243, -0.0641, -0.0868, -0.0667, 0.0374, -0.0753, -0.1861, 0.2074, -0.1181, -0.0517, 0.1289, -0.0743, -0.0411, 0.2604, -0.3507, 0.2169, 0.0971, -0.1843, 0.1379, 0.107, -0.0189, 0.1415, 0.0427, 0.0803, 0.1064, 0.0716, -0.0887, 0.1274, -0.0313, -0.0395, -0.0927, 0.0897, -0.1003, 0.1106, -0.1079, 0.1932, 0.1224, -0.0223, 0.2278, 0.0877, 0.0506, 0.1844, -0.1435, 0.0957, 0.0228, -0.1689, -0.0971, 0.0699, -0.2179, 0.0544, -0.1383, 0.0869, -0.0007, 0.0125, 0.0122, 0.0835, 0.0307, -0.0223, -0.0314, 0.0082, -0.0383, -0.0726, -0.16, 0.0846, -0.1458, -0.0561, -0.0919, 0.0711, -0.1597, 0.0259, -0.0909, -0.0476, -0.0207, -0.0404, -0.203, 0.1058, 0.0161, -0.254, 0.1803, 0.0737, -0.213, 0.3191, -0.1713, 0.0459, 0.155, -0.1654, -0.1057, 0.1905, -0.2803, -0.013, -0.0407, -0.0536, 0.0245, -0.0214, 0.0613, 0.1294, 0.109, 0.1003, 0.064, 0.249, -0.0498, 0.1275, -0.0577, 0.0724, -0.0225, -0.096, -0.0553, 0.1337, -0.1608, 0.0805, 0.0676, 0.0142, 0.1799, -0.0056, 0.0782, 0.194, -0.0495, 0.1079, -0.0685, 0.1496, -0.0668, -0.0506, 0.0282, 0.075, -0.1404, 0.101, -0.06, 0.0034, 0.0495, -0.1267, -0.0264, 0.0439, -0.1089, -0.0913, -0.023, 0.0622, -0.1517, 0.0668, -0.0187, 0.082, -0.0655, 0.0897, -0.0955, 0.0317, -0.0037, -0.2355, -0.0511, 0.013, -0.3099, -0.0708, -0.0024, -0.1779, 0.032, 0.0101, -0.0938, 0.2676, -0.1074, 0.1045, 0.0419, 0.0696, -0.0292, -0.0881, 0.0064, -0.025, -0.1688, -0.0213, -0.0484, -0.0312, 0.0267, -0.0532, 0.0894, 0.1309, -0.0425, 0.154, -0.0095, 0.1914, -0.0589, 0.0434, 0.0786, 0.0395, 0.0062, -0.0036, 0.1074, 0.0606, -0.0387, 0.1178, 0.0166, 0.0087, 0.1227, -0.1441, 0.0288, 0.2237, -0.3334, 0.1929, 0.0768, -0.0947, 0.1539, 0.0707, -0.0062, 0.2133, 0.0171, -0.0656, 0.159, -0.0327, -0.1372, -0.0427, -0.0548, -0.1099, -0.1592, -0.0117, -0.1085, 0.0496, -0.0653, 0.0401, 0.0453, 0.1085, -0.0263, -0.0189, 0.1175, -0.102, -0.0715, -0.0934, -0.0759, -0.0815, -0.1997, -0.0432, -0.0603, -0.0796, -0.0267, -0.0217, -0.0493, 0.1745, -0.1957, 0.0474, 0.1343, -0.1814, 0.0738, -0.0538, -0.0107, 0.0512, -0.0847, 0.0142, 0.0885, -0.026, -0.0137, 0.0477, -0.0251, 0.062, -0.1023, -0.0095, 0.0368, 0.0234, -0.1167, 0.1051, 0.1757, -0.1411, 0.2978, 0.0432, 0.0216, 0.345, -0.119, 0.0121, 0.2963, -0.2146, -0.0749, 0.1752, -0.2453, 0.0522, -0.0088, -0.0973, 0.152, 0.0367, 0.0428, 0.0748, 0.2328, -0.0038, 0.0457, 0.1072, 0.0174, -0.0456, -0.0468, -0.0527, -0.0593, -0.0372, -0.158, 0.0123, -0.0047, -0.0718, 0.0016, -0.0304, 0.0647, -0.0488, -0.0413, -0.0538, 0.1099, -0.196, -0.0212, 0.0534, -0.151, 0.0643, -0.0775, -0.0777, 0.1116, -0.1122, -0.1151, 0.0499, -0.0935, -0.1222, -0.0576, -0.1395, 0.0746, -0.2052, 0.0407, 0.0227, 0.0116, 0.0869, 0.0204, 0.0841, 0.1127, 0.0383, -0.0697, 0.0569, 0.0589, -0.2245, -0.005, 0.0184, -0.1582, 0.0021, 0.0904, -0.1821, 0.3469, -0.0414, 0.0061, 0.3319, 0.0174, 0.0617, 0.1268, 0.0317, 0.0699, -0.0472, 0.0021, 0.0092, -0.0043, -0.0064, -0.008, -0.0099, 0.2117, -0.1739, 0.1448, 0.0777, -0.0035, 0.0385, 0.0012, 0.0282, 0.0573, -0.0546, -0.0035, 0.0882, -0.0017, -0.0285, 0.0722, -0.0627, 0.1127, -0.1374, -0.0504, -0.0156, -0.0365, -0.2567, 0.0417, -0.112, -0.089, -0.007, -0.0689, 0.052, 0.0524, -0.0033, 0.0158, 0.0471, 0.1084, -0.2354, 0.0602, -0.0496, -0.1846, -0.14, -0.0188, -0.2578, 0.0739, -0.143, -0.0808, 0.1353, 0.0116, -0.0259, 0.0934, 0.1326, -0.0095, -0.0328, 0.1381, -0.1383, 0.101, -0.121, -0.0355, 0.0418, -0.0006, -0.1126, 0.1472, -0.0522, 0.1384, -0.045, 0.0105, 0.2306, -0.1324, 0.0516, 0.165, -0.1369, 0.236, -0.0639, 0.0466, 0.1925, 0.0532, -0.066, 0.2563, -0.0677, 0.0948, -0.0459, -0.0262, 0.0461, -0.0809, -0.0987, 0.0405, -0.0088, -0.0123, 0.0264, 0.1017, 0.0206, 0.2229, -0.1099, 0.1607, 0.0831, -0.0436, -0.134, 0.1037, -0.1876, -0.1249, -0.0591, -0.1548, -0.0879, 0.0398, -0.1767, 0.0012, 0.1756, -0.1089, -0.0802, 0.2992, -0.2461, 0.093, -0.037, -0.1205, -0.0139, -0.0176, -0.2518, 0.0631, -0.0367, -0.1351, -0.0307, 0.0322, -0.0522, -0.0155, -0.051, 0.0031, -0.0059, 0.001, -0.1685, 0.2241, -0.1633, 0.1074, 0.0286, -0.0219, 0.2003, 0.0106, -0.1069, 0.2888, -0.1086, -0.0567, 0.1049, -0.1482, 0.0334, 0.0096, -0.1991, 0.238, -0.0901, 0.1234, 0.0498, 0.1657, 0.1495, 0.1111, 0.0278, 0.2236, 0.0072, -0.0303, 0.0284, -0.0158, -0.0739, -0.0309, -0.0827, 0.001, 0.0157, 0.0519, -0.1305, 0.2891, -0.0258, 0.0122, 0.089, 0.1191, -0.1043, 0.071, -0.0318, -0.1065, 0.0749, -0.0959, -0.1833, 0.165, -0.1046, -0.1445, 0.0654, -0.0005, -0.1782, 0.108, -0.2203, 0.0547, -0.0715, -0.101, -0.0671, 0.0498, -0.0391, -0.0615, 0.049, 0.0363, -0.0095, 0.0036, -0.09, 0.0839, -0.1302, -0.1256, -0.0584, -0.0564, -0.1926, 0.066, -0.2271, 0.155, 0.0182, -0.0793, 0.2074, 0.0735, 0.0823, 0.084, 0.0036, 0.1742, -0.1058, -0.0227, 0.0324, -0.1079, -0.0169, 0.0335, -0.2272, 0.3059, -0.0945, -0.021, 0.2394, 0.054, 0.0487, 0.1318, 0.0604, 0.0691, 0.0721, -0.0037, -0.0131, 0.1247, -0.034, -0.0192, 0.0287, 0.1476, -0.1216, 0.0804, 0.009, 0.0425, -0.0601, 0.0043, -0.0276, -0.0223, 0.0435, -0.1204, 0.0463, 0.1157, -0.0752, 0.0496, 0.0664, 0.0749, -0.0793, 0.0403, -0.0799, -0.0149, -0.147, -0.1128, -0.1494, -0.0324, -0.1548, -0.136, 0.0575, -0.0538, 0.0278, -0.008, 0.0623, 0.1263, -0.0974, 0.0629, -0.0351, -0.0117, -0.1306, -0.0836, -0.0998, -0.0606, -0.1173, -0.0655, -0.0691, 0.1097, -0.0509, -0.1145, 0.3301, -0.1374, -0.006, 0.2604, -0.2426, 0.1971, 0.0542, -0.2217, 0.2035, 0.0928, -0.2271, 0.2253, 0.0221, -0.0274, 0.1142, -0.0462, 0.0718, 0.0226, 0.0038, -0.0605, 0.0864, 0.057, -0.0666, 0.1215, 0.0691, 0.1408, 0.0359, 0.1055, 0.1456, 0.0769, -0.026, 0.0615, -0.0055, -0.0741, -0.0133, -0.1779, 0.03, -0.0426, -0.1013])
      

# Discrete Cosine works

    Code
      class(ft_discrete_cosine_transform(sc, "a", "b"))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(ft_discrete_cosine_transform(ml_pipeline(sc), "a", "b"))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x)
    Output
      [[1]]
      DenseVector([0.4063, -0.151, 0.0764, 0.2688, -0.0889, 0.0285, 0.0943, -0.2138, 0.0875, -0.0171, -0.1472, 0.0205, 0.0818, -0.0261, 0.0428, 0.0366, 0.1673, -0.0501, 0.135, -0.0842, 0.154, -0.0775, -0.038, -0.0099, -0.0187, -0.0396, -0.042, -0.0864, 0.0686, -0.0516, -0.1092, -0.0096, 0.0318, -0.174, -0.0046, -0.1236, 0.0189, -0.1394, 0.0274, -0.1352, 0.1185, -0.0216, -0.0613, 0.0733, 0.0515, -0.0491, -0.0455, -0.0439, -0.0119, -0.1716, -0.0824, -0.1275, -0.0297, -0.14, 0.0185, -0.1034, 0.1653, 0.0012, 0.0521, 0.0717, 0.2326, -0.0553, 0.0061, 0.2039, -0.1578, 0.0063, 0.0767, -0.2898, 0.2057, -0.0703, -0.1755, 0.1938, 0.0889, -0.1371, 0.2876, -0.0553, 0.1855, 0.0577, -0.0004, 0.1359, 0.0171, 0.0512, -0.0068, 0.0075, 0.1605, -0.0936, 0.0503, 0.0777, 0.0459, -0.0407, 0.0599, -0.0691, 0.1176, -0.1557, 0.0189, -0.0168, -0.0014, -0.0062, -0.0301, 0.0786, 0.0667, 0.0272, 0.0083, 0.0579, 0.1126, -0.1821, 0.0293, -0.0584, -0.1259, -0.1536, -0.0515, -0.2385, 0.0567, -0.135, -0.1258, 0.1173, 0.0279, -0.0625, 0.0695, 0.1148, -0.0515, -0.0089, 0.0186, -0.1476, 0.0411, -0.1806, -0.1031, -0.0828, 0.018, -0.1864, -0.0136, 0.0765, -0.0221, -0.046, 0.116, 0.0049, 0.0131, 0.0954, -0.1181, 0.1167, 0.0636, -0.1526, 0.1678, -0.0566, 0.1273, -0.0285, -0.0008, 0.1694, -0.0213, -0.0687, 0.1613, -0.1157, 0.0565, 0.0486, -0.1784, 0.2375, -0.009, -0.0522, 0.2332, 0.0304, 0.1674, 0.0564, 0.0977, 0.1068, 0.076, -0.1017, 0.0483, -0.0252, -0.1109, -0.0559, -0.071, -0.0435, 0.0281, -0.0206, -0.0695, 0.2644, -0.0136, -0.0752, 0.3036, -0.1102, 0.0257, 0.0551, -0.1461, -0.0489, 0.0379, -0.2767, -0.0666, 0.0796, -0.228, -0.0526, 0.0475, -0.0532, -0.063, 0.0546, -0.0955, 0.0087, 0.0494, -0.2002, 0.0495, -0.0047, -0.0693, -0.0875, 0.0574, -0.0121, -0.0532, 0.0241, -0.0795, 0.0794, -0.0923, -0.1064, 0.0246, -0.0676, -0.1015, 0.0272, -0.1138, 0.0975, 0.1055, -0.1856, 0.3421, 0.0471, -0.03, 0.2678, -0.0711, 0.1219, 0.0505, -0.1432, 0.0472, 0.0187, -0.1774, 0.0559, -0.0655, 0.0755, 0.0632, -0.0462, 0.2412, 0.0968, 0.0718, 0.1123, 0.141, 0.0509, 0.006, 0.0818, -0.131, 0.1227, -0.0634, -0.1613, 0.1114, 0.0558, -0.2131, 0.1684, 0.0237, -0.0905, 0.1543, -0.1017, 0.0044, 0.0899, -0.0887, -0.0741, 0.0519, 0.0532, -0.1867, 0.1054, -0.0093, -0.0287, -0.0269, -0.0115, -0.1026, 0.0297, -0.1462, -0.1685, 0.0176, -0.1394, -0.1349, -0.0409, -0.0325, 0.0131, -0.0224, 0.0208, 0.0657, 0.1409, -0.1617, 0.1702, -0.0653, -0.0647, -0.0033, -0.1974, -0.0502, 0.0064, -0.2542, 0.0088, 0.053, -0.0779, 0.0825, 0.0326, 0.1172, 0.1542, -0.0808, 0.2543, -0.0792, 0.1257, 0.0068, -0.1113, 0.1189, 0.0291, -0.1846, 0.146, 0.0463, -0.051, 0.0953, 0.0432, 0.0454, 0.0974, -0.0006, 0.0381, 0.0326, 0.1694, -0.1942, 0.1882, 0.0656, -0.0029, 0.0615, 0.085, 0.0532, 0.0674, -0.0346, 0.0351, -0.0157, -0.0334, -0.0855, -0.114, 0.0148, -0.0264, -0.2345, 0.2021, -0.0881, 0.0564, 0.0372, 0.064, 0.0484, 0.0925, -0.0987, 0.0125, 0.0043, -0.1559, -0.1289, -0.0944, -0.1383, -0.0656, -0.2086, 0.0101, -0.0188, -0.0195, -0.0824, 0.1764, -0.0884, 0.1097, -0.0624, 0.0043, 0.0243, -0.0641, -0.0868, -0.0667, 0.0374, -0.0753, -0.1861, 0.2074, -0.1181, -0.0517, 0.1289, -0.0743, -0.0411, 0.2604, -0.3507, 0.2169, 0.0971, -0.1843, 0.1379, 0.107, -0.0189, 0.1415, 0.0427, 0.0803, 0.1064, 0.0716, -0.0887, 0.1274, -0.0313, -0.0395, -0.0927, 0.0897, -0.1003, 0.1106, -0.1079, 0.1932, 0.1224, -0.0223, 0.2278, 0.0877, 0.0506, 0.1844, -0.1435, 0.0957, 0.0228, -0.1689, -0.0971, 0.0699, -0.2179, 0.0544, -0.1383, 0.0869, -0.0007, 0.0125, 0.0122, 0.0835, 0.0307, -0.0223, -0.0314, 0.0082, -0.0383, -0.0726, -0.16, 0.0846, -0.1458, -0.0561, -0.0919, 0.0711, -0.1597, 0.0259, -0.0909, -0.0476, -0.0207, -0.0404, -0.203, 0.1058, 0.0161, -0.254, 0.1803, 0.0737, -0.213, 0.3191, -0.1713, 0.0459, 0.155, -0.1654, -0.1057, 0.1905, -0.2803, -0.013, -0.0407, -0.0536, 0.0245, -0.0214, 0.0613, 0.1294, 0.109, 0.1003, 0.064, 0.249, -0.0498, 0.1275, -0.0577, 0.0724, -0.0225, -0.096, -0.0553, 0.1337, -0.1608, 0.0805, 0.0676, 0.0142, 0.1799, -0.0056, 0.0782, 0.194, -0.0495, 0.1079, -0.0685, 0.1496, -0.0668, -0.0506, 0.0282, 0.075, -0.1404, 0.101, -0.06, 0.0034, 0.0495, -0.1267, -0.0264, 0.0439, -0.1089, -0.0913, -0.023, 0.0622, -0.1517, 0.0668, -0.0187, 0.082, -0.0655, 0.0897, -0.0955, 0.0317, -0.0037, -0.2355, -0.0511, 0.013, -0.3099, -0.0708, -0.0024, -0.1779, 0.032, 0.0101, -0.0938, 0.2676, -0.1074, 0.1045, 0.0419, 0.0696, -0.0292, -0.0881, 0.0064, -0.025, -0.1688, -0.0213, -0.0484, -0.0312, 0.0267, -0.0532, 0.0894, 0.1309, -0.0425, 0.154, -0.0095, 0.1914, -0.0589, 0.0434, 0.0786, 0.0395, 0.0062, -0.0036, 0.1074, 0.0606, -0.0387, 0.1178, 0.0166, 0.0087, 0.1227, -0.1441, 0.0288, 0.2237, -0.3334, 0.1929, 0.0768, -0.0947, 0.1539, 0.0707, -0.0062, 0.2133, 0.0171, -0.0656, 0.159, -0.0327, -0.1372, -0.0427, -0.0548, -0.1099, -0.1592, -0.0117, -0.1085, 0.0496, -0.0653, 0.0401, 0.0453, 0.1085, -0.0263, -0.0189, 0.1175, -0.102, -0.0715, -0.0934, -0.0759, -0.0815, -0.1997, -0.0432, -0.0603, -0.0796, -0.0267, -0.0217, -0.0493, 0.1745, -0.1957, 0.0474, 0.1343, -0.1814, 0.0738, -0.0538, -0.0107, 0.0512, -0.0847, 0.0142, 0.0885, -0.026, -0.0137, 0.0477, -0.0251, 0.062, -0.1023, -0.0095, 0.0368, 0.0234, -0.1167, 0.1051, 0.1757, -0.1411, 0.2978, 0.0432, 0.0216, 0.345, -0.119, 0.0121, 0.2963, -0.2146, -0.0749, 0.1752, -0.2453, 0.0522, -0.0088, -0.0973, 0.152, 0.0367, 0.0428, 0.0748, 0.2328, -0.0038, 0.0457, 0.1072, 0.0174, -0.0456, -0.0468, -0.0527, -0.0593, -0.0372, -0.158, 0.0123, -0.0047, -0.0718, 0.0016, -0.0304, 0.0647, -0.0488, -0.0413, -0.0538, 0.1099, -0.196, -0.0212, 0.0534, -0.151, 0.0643, -0.0775, -0.0777, 0.1116, -0.1122, -0.1151, 0.0499, -0.0935, -0.1222, -0.0576, -0.1395, 0.0746, -0.2052, 0.0407, 0.0227, 0.0116, 0.0869, 0.0204, 0.0841, 0.1127, 0.0383, -0.0697, 0.0569, 0.0589, -0.2245, -0.005, 0.0184, -0.1582, 0.0021, 0.0904, -0.1821, 0.3469, -0.0414, 0.0061, 0.3319, 0.0174, 0.0617, 0.1268, 0.0317, 0.0699, -0.0472, 0.0021, 0.0092, -0.0043, -0.0064, -0.008, -0.0099, 0.2117, -0.1739, 0.1448, 0.0777, -0.0035, 0.0385, 0.0012, 0.0282, 0.0573, -0.0546, -0.0035, 0.0882, -0.0017, -0.0285, 0.0722, -0.0627, 0.1127, -0.1374, -0.0504, -0.0156, -0.0365, -0.2567, 0.0417, -0.112, -0.089, -0.007, -0.0689, 0.052, 0.0524, -0.0033, 0.0158, 0.0471, 0.1084, -0.2354, 0.0602, -0.0496, -0.1846, -0.14, -0.0188, -0.2578, 0.0739, -0.143, -0.0808, 0.1353, 0.0116, -0.0259, 0.0934, 0.1326, -0.0095, -0.0328, 0.1381, -0.1383, 0.101, -0.121, -0.0355, 0.0418, -0.0006, -0.1126, 0.1472, -0.0522, 0.1384, -0.045, 0.0105, 0.2306, -0.1324, 0.0516, 0.165, -0.1369, 0.236, -0.0639, 0.0466, 0.1925, 0.0532, -0.066, 0.2563, -0.0677, 0.0948, -0.0459, -0.0262, 0.0461, -0.0809, -0.0987, 0.0405, -0.0088, -0.0123, 0.0264, 0.1017, 0.0206, 0.2229, -0.1099, 0.1607, 0.0831, -0.0436, -0.134, 0.1037, -0.1876, -0.1249, -0.0591, -0.1548, -0.0879, 0.0398, -0.1767, 0.0012, 0.1756, -0.1089, -0.0802, 0.2992, -0.2461, 0.093, -0.037, -0.1205, -0.0139, -0.0176, -0.2518, 0.0631, -0.0367, -0.1351, -0.0307, 0.0322, -0.0522, -0.0155, -0.051, 0.0031, -0.0059, 0.001, -0.1685, 0.2241, -0.1633, 0.1074, 0.0286, -0.0219, 0.2003, 0.0106, -0.1069, 0.2888, -0.1086, -0.0567, 0.1049, -0.1482, 0.0334, 0.0096, -0.1991, 0.238, -0.0901, 0.1234, 0.0498, 0.1657, 0.1495, 0.1111, 0.0278, 0.2236, 0.0072, -0.0303, 0.0284, -0.0158, -0.0739, -0.0309, -0.0827, 0.001, 0.0157, 0.0519, -0.1305, 0.2891, -0.0258, 0.0122, 0.089, 0.1191, -0.1043, 0.071, -0.0318, -0.1065, 0.0749, -0.0959, -0.1833, 0.165, -0.1046, -0.1445, 0.0654, -0.0005, -0.1782, 0.108, -0.2203, 0.0547, -0.0715, -0.101, -0.0671, 0.0498, -0.0391, -0.0615, 0.049, 0.0363, -0.0095, 0.0036, -0.09, 0.0839, -0.1302, -0.1256, -0.0584, -0.0564, -0.1926, 0.066, -0.2271, 0.155, 0.0182, -0.0793, 0.2074, 0.0735, 0.0823, 0.084, 0.0036, 0.1742, -0.1058, -0.0227, 0.0324, -0.1079, -0.0169, 0.0335, -0.2272, 0.3059, -0.0945, -0.021, 0.2394, 0.054, 0.0487, 0.1318, 0.0604, 0.0691, 0.0721, -0.0037, -0.0131, 0.1247, -0.034, -0.0192, 0.0287, 0.1476, -0.1216, 0.0804, 0.009, 0.0425, -0.0601, 0.0043, -0.0276, -0.0223, 0.0435, -0.1204, 0.0463, 0.1157, -0.0752, 0.0496, 0.0664, 0.0749, -0.0793, 0.0403, -0.0799, -0.0149, -0.147, -0.1128, -0.1494, -0.0324, -0.1548, -0.136, 0.0575, -0.0538, 0.0278, -0.008, 0.0623, 0.1263, -0.0974, 0.0629, -0.0351, -0.0117, -0.1306, -0.0836, -0.0998, -0.0606, -0.1173, -0.0655, -0.0691, 0.1097, -0.0509, -0.1145, 0.3301, -0.1374, -0.006, 0.2604, -0.2426, 0.1971, 0.0542, -0.2217, 0.2035, 0.0928, -0.2271, 0.2253, 0.0221, -0.0274, 0.1142, -0.0462, 0.0718, 0.0226, 0.0038, -0.0605, 0.0864, 0.057, -0.0666, 0.1215, 0.0691, 0.1408, 0.0359, 0.1055, 0.1456, 0.0769, -0.026, 0.0615, -0.0055, -0.0741, -0.0133, -0.1779, 0.03, -0.0426, -0.1013])
      

# R Formula works

    Code
      class(ft_r_formula(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_r_formula(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      ft_r_formula(tbl_mtcars, mpg ~ ., features_col = "test") %>% colnames()
    Output
       [1] "mpg"   "cyl"   "disp"  "hp"    "drat"  "wt"    "qsec"  "vs"    "am"   
      [10] "gear"  "carb"  "test"  "label"

# Tokenizer works

    Code
      class(ft_tokenizer(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_tokenizer(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x, token_x)
    Output
      [[1]]
       [1] "this"    "has"     "been"    "the"     "best"    "tv"      "i've"   
       [8] "ever"    "used."   "great"   "screen," "and"     "sound." 
      

# Stop words remover works

    Code
      class(ft_tokenizer(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_tokenizer(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x, stop_x)
    Output
      [[1]]
      [1] "best"    "tv"      "ever"    "used."   "great"   "screen," "sound." 
      

# Hashing TF works

    Code
      class(ft_hashing_tf(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_hashing_tf(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x, hashed_x)
    Output
      [[1]]
      SparseVector(1024, {26: 1.0, 139: 1.0, 515: 1.0, 713: 1.0, 723: 1.0, 750: 1.0, 806: 1.0})
      

# Normalizer works

    Code
      class(ft_hashing_tf(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_hashing_tf(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      dplyr::pull(x, normal_x)
    Output
      [[1]]
      SparseVector(1024, {26: 0.378, 139: 0.378, 515: 0.378, 713: 0.378, 723: 0.378, 750: 0.378, 806: 0.378})
      

# String indexer works

    Code
      class(ft_string_indexer(ml_pipeline(sc)))
    Output
      [1] "ml_connect_pipeline"       "ml_pipeline"              
      [3] "ml_connect_estimator"      "ml_estimator"             
      [5] "ml_connect_pipeline_stage" "ml_pipeline_stage"        

---

    Code
      class(ft_string_indexer(sc))
    Output
      [1] "ml_transformer"       "ml_connect_estimator" "ml_estimator"        
      [4] "ml_pipeline_stage"   

---

    Code
      class(x)
    Output
      [1] "tbl_pyspark" "tbl_spark"   "tbl_sql"     "tbl_lazy"    "tbl"        

---

    Code
      table(dplyr::pull(x))
    Output
      
       0  1  2 
      50 50 50 

